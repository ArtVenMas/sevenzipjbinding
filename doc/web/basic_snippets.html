<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta name="verify-v1" content="mCmiZMVFK9OR5rFvabIsFhsHCfxvP4vfF5pvGSCjHOg=" />
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1" />
<title>Welcome to 7-Zip-JBinding project</title>
<link href="styles.css" rel="stylesheet" type="text/css" />
<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://sourceforge.net/apps/piwik/sevenzipjbind/" : "http://sourceforge.net/apps/piwik/sevenzipjbind/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
piwik_action_name = '';
piwik_idsite = 1;
piwik_url = pkBaseURL + "piwik.php";
piwik_log(piwik_action_name, piwik_idsite, piwik_url);
</script>
<object><noscript><p><img src="http://sourceforge.net/apps/piwik/sevenzipjbind/piwik.php?idsite=1" alt="piwik"/></p></noscript></object>
<!-- End Piwik Tag -->
</head>
<body>
<center>
<table><tr><td width="1000" align="left">
<a href="http://sourceforge.net/donate/index.php?group_id=210915"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" alt="Support This Project" /></a>
<a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=210915&amp;type=2" width="125" height="37" border="0" alt="SourceForge.net Logo" /></a>
<!--&nbsp;<font size="+1">7-Zip-JBinding</font><br/> -->

<table border="0" width="100%">
<tr><td></td><td align="center"><img src="logo2.png" alt="Logo" /></td></tr>
<tr><td height="50"></td></tr>
<tr><td width="240" valign="top" class="menu">
<table class="menu" border="0">
<tr><td><a href="index.html">Home</a></td></tr>
<tr><td><a href="first_steps.html">Documentation</a><br/>
<table class="submenu" border="0">
	<tr><td><a href="first_steps.html" >First steps</a></td></tr>
	<tr><td><a href="basic_snippets.html" class="submenu">Code snippets</a></td></tr>
	<tr><td><a href="javadoc/index.html" class="submenu">JavaDoc</a></td></tr>
</table></td></tr>
<tr><td><a href="http://sourceforge.net/project/showfiles.php?group_id=210915" class="menu">Download</a></td></tr>
<tr><td><a href="http://my.cdash.org/index.php?project=7-Zip-JBinding" class="menu">Test Dashboard</a></td></tr>
<tr><td><a href="http://sourceforge.net/forum/?group_id=210915" class="menu">Forum</a></td></tr>
<tr><td><a href="http://sourceforge.net/tracker/?group_id=210915" class="menu">Tracker</a></td></tr>
<tr><td><a href="http://sourceforge.net/donate/index.php?group_id=210915" class="menu">Donate Money to<br/>7-Zip-JBinding</a></td></tr>
</table>
<br/><br/>
<iframe marginheight="0" marginwidth="0" frameborder="0" height="1000" scrolling="no" width="220" src="voting.php">Your browser does not support iframes</iframe>
</td><td align="left">
<h1>Code snippets</h1>
<ul>
	<li><a href="#overview">Overview</a></li>
	<li><a href="#std-vs-simple">Standard vs Simple interface</a></li>
	<li><a href="#quering-archive">Quering items in archive</a>
	<ul>
		<li><a href="#quering-archive-simple-int">Simple interface</a></li>
		<li><a href="#quering-archive-std-int">Standard interface</a></li>
	</ul>
	</li>
	<li><a href="#extraction-single-file"> Extraction of a single
	file</a>
	<ul>
		<li><a href="#extraction-single-file-simple-int">Simple
		interface</a></li>
		<li><a href="#extraction-single-file-std-int">Standard
		interface</a>
		<ul>
			<li><a href="#extracting-archive-std-int-callback">
			Extracting archive using standard interface and call back method as a
			filter</a></li>
			<li><a href="#extracting-archive-std-int-prepared-list">
			Extracting archive using standard interface and prepared list of
			items to extract</a></li>
		</ul>
		</li>
	</ul>
	</li>
	<li><a href="#open-multipart-7z-archives">Open multi-part 7z
	archives</a></li>
</ul>
<h2><a name="overview">Overview</a></h2>
<p>Here you can find many simple code snippets, example of how to
preform basic operations with 7-Zip-JBinding. All outputs of the code
snippets were produced using a single test archive <a href="simple.zip"><span
	class="filename">simple.zip</span></a>. Here is a content of the test
archive:</p>
<div class="fragment"><pre class="fragment">
$ 7z l simple.zip
7-Zip  4.58 beta  Copyright (c) 1999-2008 Igor Pavlov  2008-05-05
p7zip Version 4.58 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,2 CPUs)
Listing archive: simple.zip
   Date      Time    Attr         Size   Compressed  Name
------------------- ----- ------------ ------------  ------------------------
2009-08-04 12:26:16 .....         4481           68  file1.txt
2009-08-04 12:27:34 .....           75           62  file2.txt
2009-08-04 14:53:06 D....            0            0  folder
2009-08-04 14:53:40 .....            6            6  folder/file in folder.txt
------------------- ----- ------------ ------------  ------------------------
                                  4562          136  3 files, 1 folders
</pre></div>
<br />
<h2><a name="std-vs-simple">Standard vs Simple interface</a></h2>
<p>The 7-Zip-JBinding library offers two different interfaces:
standard and simple. The standard interface directly maps all native
7-Zip library methods providing C++ like interface. The simple interface
is a try to provide more Java-like easy to use interface. It was
designed either for quick coding and easy start and not for feature
richness nor for performance.</p>
<p>The following examples will be presented in both standard and
simple interface beginning with as simple interface. Please note, that
the full performance can only be reached with the standard interface.</p>
<br />
<h2><a name="quering-archive">Quering items in archive</a></h2>
<h3><a name="quering-archive-simple-int">Simple interface</a></h3>
<p>This example shows how to print a list of items of archive using
simple interface.</p>
<div class="fragment"><pre class="fragment">
<span class="java-keyword">import</span> java.io.IOException;
<span class="java-keyword">import</span> java.io.RandomAccessFile;

<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISevenZipInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZip;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZipException;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.simple.ISimpleInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.simple.ISimpleInArchiveItem;

<span class="java-keyword">public</span> <span class="java-keyword">class</span> ListItemsSimple {
    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">void</span> main(String[] args) {
        <span class="java-keyword">if</span> (args.<span class="java-field">length</span> == 0) {
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"Usage: java ListItemsSimple &#60;archive-name&#62;"</span>);
        }
        RandomAccessFile randomAccessFile = <span class="java-keyword">null</span>;
        ISevenZipInArchive inArchive = <span class="java-keyword">null</span>;
        <span class="java-keyword">try</span> {
            randomAccessFile = <span class="java-keyword">new</span> RandomAccessFile(args[0], <span class="java-string">"r"</span>);
            inArchive = SevenZip.<span class="java-staticmethod">openInArchive</span>(<span class="java-keyword">null</span>, <span class="java-comment">// autodetect archive type</span>
                    <span class="java-keyword">new</span> RandomAccessFileInStream(randomAccessFile));

            <span class="java-comment">// Getting simple interface of the archive inArchive</span>
            ISimpleInArchive simpleInArchive = inArchive.getSimpleInterface();

            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"   Size   | Compr.Sz. | Filename"</span>);
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"----------+-----------+---------"</span>);

            <span class="java-keyword">for</span> (ISimpleInArchiveItem item : simpleInArchive.getArchiveItems()) {
                System.<span class="java-staticfield">out</span>.println(String.<span class="java-staticmethod">format</span>(<span class="java-string">"%9s | %9s | %s"</span>, <span class="java-comment">// </span>
                        item.getSize(), 
                        item.getPackedSize(), 
                        item.getPath()));
            }
        } <span class="java-keyword">catch</span> (Exception e) {
            System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error occurs: "</span> + e);
            System.<span class="java-staticmethod">exit</span>(1);
        } <span class="java-keyword">finally</span> {
            <span class="java-keyword">if</span> (inArchive != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    inArchive.close();
                } <span class="java-keyword">catch</span> (SevenZipException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing archive: "</span> + e);
                }
            }
            <span class="java-keyword">if</span> (randomAccessFile != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    randomAccessFile.close();
                } <span class="java-keyword">catch</span> (IOException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing file: "</span> + e);
                }
            }
        }
    }
}
</pre></div>
<div class="snippet-info"><a href="snippets/ListItemsSimple.java">download java code</a></div>
<p>The output for the test archive:</p>
<div class="fragment"><pre class="fragment">
   Size   | Compr.Sz. | Filename
----------+-----------+---------
     4481 |        68 | file1.txt
       75 |        62 | file2.txt
        0 |         0 | folder
        6 |         6 | folder/file in folder.txt
</pre></div>
<p>Please note, that not all archive formats support the "folder"
items, like "folder/" in our example. Also please note, that packed size
in this example as almost all other properties can return null. A
returned null value means, that either the property is not supported by
the particular archive format or not known for the particular item.</p>
<h3><a name="quering-archive-std-int">Standard interface</a></h3>
<p>This example shows how to print a list of items of archive using
standard interface.</p>
<div class="fragment"><pre class="fragment">
<span class="java-keyword">import</span> java.io.IOException;
<span class="java-keyword">import</span> java.io.RandomAccessFile;

<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISevenZipInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.PropID;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZip;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZipException;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;

<span class="java-keyword">public</span> <span class="java-keyword">class</span> ListItemsStandard {
    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">void</span> main(String[] args) {
        <span class="java-keyword">if</span> (args.<span class="java-field">length</span> == 0) {
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"Usage: java ListItemsStandard &#60;archive-name&#62;"</span>);
        }
        RandomAccessFile randomAccessFile = <span class="java-keyword">null</span>;
        ISevenZipInArchive inArchive = <span class="java-keyword">null</span>;
        <span class="java-keyword">try</span> {
            randomAccessFile = <span class="java-keyword">new</span> RandomAccessFile(args[0], <span class="java-string">"r"</span>);
            inArchive = SevenZip.<span class="java-staticmethod">openInArchive</span>(<span class="java-keyword">null</span>, <span class="java-comment">// autodetect archive type</span>
                    <span class="java-keyword">new</span> RandomAccessFileInStream(randomAccessFile));

            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"   Size   | Compr.Sz. | Filename"</span>);
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"----------+-----------+---------"</span>);
            <span class="java-keyword">int</span> itemCount = inArchive.getNumberOfItems();
            <span class="java-keyword">for</span> (<span class="java-keyword">int</span> i = 0; i &#60; itemCount; i++) {
                System.<span class="java-staticfield">out</span>.println(String.<span class="java-staticmethod">format</span>(<span class="java-string">"%9s | %9s | %s"</span>, <span class="java-comment">// </span>
                        inArchive.getProperty(i, PropID.SIZE), 
                        inArchive.getProperty(i, PropID.PACKED_SIZE), 
                        inArchive.getProperty(i, PropID.PATH)));
            }
        } <span class="java-keyword">catch</span> (Exception e) {
            System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error occurs: "</span> + e);
            System.<span class="java-staticmethod">exit</span>(1);
        } <span class="java-keyword">finally</span> {
            <span class="java-keyword">if</span> (inArchive != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    inArchive.close();
                } <span class="java-keyword">catch</span> (SevenZipException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing archive: "</span> + e);
                }
            }
            <span class="java-keyword">if</span> (randomAccessFile != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    randomAccessFile.close();
                } <span class="java-keyword">catch</span> (IOException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing file: "</span> + e);
                }
            }
        }
    }
}
</pre></div>
<div class="snippet-info"><a href="snippets/ListItemsStandard.java">download java code</a></div>
<p>The output for the test archive is the same:</p>
<div class="fragment"><pre class="fragment">
   Size   | Compr.Sz. | Filename
----------+-----------+---------
     4481 |        68 | file1.txt
       75 |        62 | file2.txt
        0 |         0 | folder
        6 |         6 | folder/file in folder.txt
</pre></div>
<h2><a name="extraction-single-file">Extraction of a single
file</a></h2>
<p>This section will show how to access the compressed data of the
archive items. The following examples will calculate a simple checksum
of each archive item.</p>
<h3><a name="extraction-single-file-simple-int">Simple
interface</a></h3>
<p>This example shows how to get content of the items of the archive
using simple interface. In order to consume extracted content the simple
checksum will be calculated.</p>
<div class="fragment"><pre class="fragment">
<span class="java-keyword">import</span> java.io.IOException;
<span class="java-keyword">import</span> java.io.RandomAccessFile;
<span class="java-keyword">import</span> java.util.Arrays;

<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ExtractOperationResult;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISequentialOutStream;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISevenZipInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZip;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZipException;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.simple.ISimpleInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.simple.ISimpleInArchiveItem;

<span class="java-keyword">public</span> <span class="java-keyword">class</span> ExtractItemsSimple {
    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">void</span> main(String[] args) {
        <span class="java-keyword">if</span> (args.<span class="java-field">length</span> == 0) {
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"Usage: java ExtractItemsSimple &#60;archive-name&#62;"</span>);
        }
        RandomAccessFile randomAccessFile = <span class="java-keyword">null</span>;
        ISevenZipInArchive inArchive = <span class="java-keyword">null</span>;
        <span class="java-keyword">try</span> {
            randomAccessFile = <span class="java-keyword">new</span> RandomAccessFile(args[0], <span class="java-string">"r"</span>);
            inArchive = SevenZip.<span class="java-staticmethod">openInArchive</span>(<span class="java-keyword">null</span>, <span class="java-comment">// autodetect archive type</span>
                    <span class="java-keyword">new</span> RandomAccessFileInStream(randomAccessFile));

            <span class="java-comment">// Getting simple interface of the archive inArchive</span>
            ISimpleInArchive simpleInArchive = inArchive.getSimpleInterface();

            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"   Hash   | Filename"</span>);
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"----------+---------"</span>);

            <span class="java-keyword">for</span> (ISimpleInArchiveItem item : simpleInArchive.getArchiveItems()) {
                final <span class="java-keyword">int</span>[] hash = <span class="java-keyword">new</span> <span class="java-keyword">int</span>[] { 0 };
                <span class="java-keyword">if</span> (!item.isFolder()) {
                    ExtractOperationResult result;
                    result = item.extractSlow(<span class="java-keyword">new</span> ISequentialOutStream() {
                        <span class="java-keyword">public</span> <span class="java-keyword">int</span> write(<span class="java-keyword">byte</span>[] data) <span class="java-keyword">throws</span> SevenZipException {
                            hash[0] |= Arrays.<span class="java-staticmethod">hashCode</span>(data);
                            <span class="java-keyword">return</span> data.length; <span class="java-comment">// Return amount of proceed data</span>
                        }
                    });
                    <span class="java-keyword">if</span> (result == ExtractOperationResult.OK) {
                        System.<span class="java-staticfield">out</span>.println(String.<span class="java-staticmethod">format</span>(<span class="java-string">"%9X | %s"</span>, <span class="java-comment">// </span>
                                hash[0], item.getPath()));
                    } else {
                        System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error extracting item: "</span> + result);
                    }
                }
            }
        } <span class="java-keyword">catch</span> (Exception e) {
            System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error occurs: "</span> + e);
            System.<span class="java-staticmethod">exit</span>(1);
        } <span class="java-keyword">finally</span> {
            <span class="java-keyword">if</span> (inArchive != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    inArchive.close();
                } <span class="java-keyword">catch</span> (SevenZipException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing archive: "</span> + e);
                }
            }
            <span class="java-keyword">if</span> (randomAccessFile != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    randomAccessFile.close();
                } <span class="java-keyword">catch</span> (IOException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing file: "</span> + e);
                }
            }
        }
    }
}
</pre></div>
<div class="snippet-info"><a href="snippets/ExtractItemsSimple.java">download java code</a></div>
<p>Here is the output of the last snippet:</p>
<div class="fragment"><pre class="fragment">
   Hash   | Filename
----------+---------
 C1FD1029 | file1.txt
 8CB12E6A | file2.txt
 E8EEC7F4 | folder/file in folder.txt
</pre></div>
<h3><a name="extraction-single-file-std-int">Standard interface</a></h3>
<p>The following two examples show how to perform the same
extracting task using standard interface. As in the previous example,
the simple checksum will be calculated in order to consume the extracted
data.</p>
<p>First example traverse the entire archive and uses call back
method to choose on the fly whether proceed with the extraction of an
item or not. The second example prepare a list of items for extraction.
</p>
<h4><a name="extracting-archive-std-int-callback"> Extracting
archive using standard interface and call back method as a filter</a></h4>
<div class="fragment"><pre class="fragment">
<span class="java-keyword">import</span> java.io.IOException;
<span class="java-keyword">import</span> java.io.RandomAccessFile;
<span class="java-keyword">import</span> java.util.Arrays;

<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ExtractAskMode;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ExtractOperationResult;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.IArchiveExtractCallback;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISequentialOutStream;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISevenZipInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.PropID;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZip;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZipException;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;

<span class="java-keyword">public</span> <span class="java-keyword">class</span> ExtractItemsStandardCallback {
    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">class</span> MyExtractCallback <span class="java-keyword">implements</span> IArchiveExtractCallback {
        <span class="java-keyword">private</span> <span class="java-keyword">int</span> <span class="java-field">hash</span> = 0;
        <span class="java-keyword">private</span> <span class="java-keyword">int</span> <span class="java-field">index</span>;
        <span class="java-keyword">private</span> boolean <span class="java-field">skipExtraction</span>;
        <span class="java-keyword">private</span> ISevenZipInArchive <span class="java-field">inArchive</span>;

        <span class="java-keyword">public</span> MyExtractCallback(ISevenZipInArchive inArchive) {
            this.<span class="java-field">inArchive</span> = inArchive;
        }

        <span class="java-keyword">public</span> ISequentialOutStream getStream(<span class="java-keyword">int</span> index, 
                ExtractAskMode extractAskMode) <span class="java-keyword">throws</span> SevenZipException {
            this.<span class="java-field">index</span> = index;
            <span class="java-field">skipExtraction</span> = (Boolean) <span class="java-field">inArchive</span>
                    .getProperty(index, PropID.<span class="java-staticfield">IS_FOLDER</span>);
            <span class="java-keyword">if</span> (<span class="java-field">skipExtraction</span>) {
                <span class="java-keyword">return</span> <span class="java-keyword">null</span>;
            }
            <span class="java-keyword">return</span> <span class="java-keyword">new</span> ISequentialOutStream() {
                <span class="java-keyword">public</span> <span class="java-keyword">int</span> write(<span class="java-keyword">byte</span>[] data) <span class="java-keyword">throws</span> SevenZipException {
                    <span class="java-field">hash</span> |= Arrays.<span class="java-staticmethod">hashCode</span>(data);
                    <span class="java-keyword">return</span> data.<span class="java-field">length</span>; <span class="java-comment">// Return amount of proceed data</span>
                }
            };
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> prepareOperation(ExtractAskMode extractAskMode) 
                <span class="java-keyword">throws</span> SevenZipException {
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> setOperationResult(ExtractOperationResult 
                extractOperationResult) <span class="java-keyword">throws</span> SevenZipException {
            <span class="java-keyword">if</span> (<span class="java-field">skipExtraction</span>) {
                <span class="java-keyword">return</span>;
            }
            <span class="java-keyword">if</span> (extractOperationResult != ExtractOperationResult.<span class="java-staticfield">OK</span>) {
                System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Extraction error"</span>);
            } else {
                System.<span class="java-staticfield">out</span>.println(String.<span class="java-staticmethod">format</span>(<span class="java-string">"%9X | %s"</span>, <span class="java-comment">// </span>
                        <span class="java-field">hash</span>, <span class="java-field">inArchive</span>.getProperty(<span class="java-field">index</span>, PropID.<span class="java-staticfield">PATH</span>)));
                <span class="java-field">hash</span> = 0;
            }
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> setCompleted(<span class="java-keyword">long</span> completeValue) <span class="java-keyword">throws</span> SevenZipException {
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> setTotal(<span class="java-keyword">long</span> total) <span class="java-keyword">throws</span> SevenZipException {
        }

    }

    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">void</span> main(String[] args) {
        <span class="java-keyword">if</span> (args.<span class="java-field">length</span> == 0) {
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"Usage: java ExtractItemsStandard &#60;arch-name&#62;"</span>);
        }
        RandomAccessFile randomAccessFile = <span class="java-keyword">null</span>;
        ISevenZipInArchive inArchive = <span class="java-keyword">null</span>;
        <span class="java-keyword">try</span> {
            randomAccessFile = <span class="java-keyword">new</span> RandomAccessFile(args[0], <span class="java-string">"r"</span>);
            inArchive = SevenZip.<span class="java-staticmethod">openInArchive</span>(<span class="java-keyword">null</span>, <span class="java-comment">// autodetect archive type</span>
                    <span class="java-keyword">new</span> RandomAccessFileInStream(randomAccessFile));

            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"   Hash   | Filename"</span>);
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"----------+---------"</span>);

            <span class="java-keyword">int</span>[] in = <span class="java-keyword">new</span> <span class="java-keyword">int</span>[inArchive.getNumberOfItems()];
            <span class="java-keyword">for</span> (<span class="java-keyword">int</span> i = 0; i &#60; in.length; i++) {
                in[i] = i;
            }
            inArchive.extract(in, false, <span class="java-comment">// Non-test mode</span>
                    <span class="java-keyword">new</span> MyExtractCallback(inArchive));
        } <span class="java-keyword">catch</span> (Exception e) {
            System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error occurs: "</span> + e);
            System.<span class="java-staticmethod">exit</span>(1);
        } <span class="java-keyword">finally</span> {
            <span class="java-keyword">if</span> (inArchive != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    inArchive.close();
                } <span class="java-keyword">catch</span> (SevenZipException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing archive: "</span> + e);
                }
            }
            <span class="java-keyword">if</span> (randomAccessFile != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    randomAccessFile.close();
                } <span class="java-keyword">catch</span> (IOException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing file: "</span> + e);
                }
            }
        }
    }
}
</pre></div>
<div class="snippet-info"><a href="snippets/ExtractItemsStandardCallback.java">download java code</a></div>
<h4><a name="extracting-archive-std-int-prepared-list">
Extracting archive using standard interface and prepared list of items
to extract</a></h4>
<div class="fragment"><pre class="fragment">
<span class="java-keyword">import</span> java.io.IOException;
<span class="java-keyword">import</span> java.io.RandomAccessFile;
<span class="java-keyword">import</span> java.util.ArrayList;
<span class="java-keyword">import</span> java.util.Arrays;
<span class="java-keyword">import</span> java.util.List;

<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ExtractAskMode;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ExtractOperationResult;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.IArchiveExtractCallback;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISequentialOutStream;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISevenZipInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.PropID;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZip;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZipException;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;

<span class="java-keyword">public</span> <span class="java-keyword">class</span> ExtractItemsStandard {
    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">class</span> MyExtractCallback <span class="java-keyword">implements</span> IArchiveExtractCallback {
        <span class="java-keyword">private</span> <span class="java-keyword">int</span> <span class="java-field">hash</span> = 0;
        <span class="java-keyword">private</span> <span class="java-keyword">int</span> <span class="java-field">index</span>;
        <span class="java-keyword">private</span> ISevenZipInArchive <span class="java-field">inArchive</span>;

        <span class="java-keyword">public</span> MyExtractCallback(ISevenZipInArchive inArchive) {
            this.<span class="java-field">inArchive</span> = inArchive;
        }

        <span class="java-keyword">public</span> ISequentialOutStream getStream(<span class="java-keyword">int</span> index, 
                ExtractAskMode extractAskMode) <span class="java-keyword">throws</span> SevenZipException {
            this.<span class="java-field">index</span> = index;
            <span class="java-keyword">return</span> <span class="java-keyword">new</span> ISequentialOutStream() {

                <span class="java-keyword">public</span> <span class="java-keyword">int</span> write(<span class="java-keyword">byte</span>[] data) <span class="java-keyword">throws</span> SevenZipException {
                    <span class="java-field">hash</span> |= Arrays.<span class="java-staticmethod">hashCode</span>(data);
                    <span class="java-keyword">return</span> data.<span class="java-field">length</span>; <span class="java-comment">// Return amount of proceed data</span>
                }
            };
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> prepareOperation(ExtractAskMode extractAskMode) 
                <span class="java-keyword">throws</span> SevenZipException {
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> setOperationResult(ExtractOperationResult 
                extractOperationResult) <span class="java-keyword">throws</span> SevenZipException {
            <span class="java-keyword">if</span> (extractOperationResult != ExtractOperationResult.<span class="java-staticfield">OK</span>) {
                System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Extraction error"</span>);
            } else {
                System.<span class="java-staticfield">out</span>.println(String.<span class="java-staticmethod">format</span>(<span class="java-string">"%9X | %s"</span>, <span class="java-comment">// </span>
                        <span class="java-field">hash</span>, <span class="java-field">inArchive</span>.getProperty(<span class="java-field">index</span>, PropID.<span class="java-staticfield">PATH</span>)));
                <span class="java-field">hash</span> = 0;
            }
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> setCompleted(<span class="java-keyword">long</span> completeValue) <span class="java-keyword">throws</span> SevenZipException {
        }

        <span class="java-keyword">public</span> <span class="java-keyword">void</span> setTotal(<span class="java-keyword">long</span> total) <span class="java-keyword">throws</span> SevenZipException {
        }

    }

    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">void</span> main(String[] args) {
        <span class="java-keyword">if</span> (args.<span class="java-field">length</span> == 0) {
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"Usage: java ExtractItemsStandard &#60;arch-name&#62;"</span>);
        }
        RandomAccessFile randomAccessFile = <span class="java-keyword">null</span>;
        ISevenZipInArchive inArchive = <span class="java-keyword">null</span>;
        <span class="java-keyword">try</span> {
            randomAccessFile = <span class="java-keyword">new</span> RandomAccessFile(args[0], <span class="java-string">"r"</span>);
            inArchive = SevenZip.<span class="java-staticmethod">openInArchive</span>(<span class="java-keyword">null</span>, <span class="java-comment">// autodetect archive type</span>
                    <span class="java-keyword">new</span> RandomAccessFileInStream(randomAccessFile));

            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"   Hash   | Filename"</span>);
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"----------+---------"</span>);

            <span class="java-keyword">int</span> count = inArchive.getNumberOfItems();
            List&#60;Integer&#62; itemsToExtract = <span class="java-keyword">new</span> ArrayList&#60;Integer&#62;();
            <span class="java-keyword">for</span> (<span class="java-keyword">int</span> i = 0; i &#60; count; i++) {
                <span class="java-keyword">if</span> (!((Boolean) inArchive.getProperty(i, PropID.<span class="java-staticfield">IS_FOLDER</span>))
                        .booleanValue()) {
                    itemsToExtract.add(Integer.<span class="java-staticmethod">valueOf</span>(i));
                }
            }
            <span class="java-keyword">int</span>[] items = <span class="java-keyword">new</span> <span class="java-keyword">int</span>[itemsToExtract.size()];
            <span class="java-keyword">int</span> i = 0;
            <span class="java-keyword">for</span> (Integer integer : itemsToExtract) {
                items[i++] = integer.intValue();
            }
            inArchive.extract(items, false, <span class="java-comment">// Non-test mode</span>
                    <span class="java-keyword">new</span> MyExtractCallback(inArchive));
        } <span class="java-keyword">catch</span> (Exception e) {
            System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error occurs: "</span> + e);
            System.<span class="java-staticmethod">exit</span>(1);
        } <span class="java-keyword">finally</span> {
            <span class="java-keyword">if</span> (inArchive != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    inArchive.close();
                } <span class="java-keyword">catch</span> (SevenZipException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing archive: "</span> + e);
                }
            }
            <span class="java-keyword">if</span> (randomAccessFile != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    randomAccessFile.close();
                } <span class="java-keyword">catch</span> (IOException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing file: "</span> + e);
                }
            }
        }
    }
}
</pre></div>
<div class="snippet-info"><a href="snippets/ExtractItemsStandard.java">download java code</a></div>
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
<h2><a name="open-multipart-7z-archives">Open multi-part 7z
archives</a></h2>
<div class="fragment"><pre class="fragment">
<span class="java-keyword">import</span> java.io.FileNotFoundException;
<span class="java-keyword">import</span> java.io.IOException;
<span class="java-keyword">import</span> java.io.RandomAccessFile;
<span class="java-keyword">import</span> java.util.HashMap;
<span class="java-keyword">import</span> java.util.Map;

<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ArchiveFormat;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.IArchiveOpenVolumeCallback;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.IInStream;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.ISevenZipInArchive;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.PropID;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZip;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.SevenZipException;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.impl.RandomAccessFileInStream;
<span class="java-keyword">import</span> net.sf.sevenzipjbinding.impl.VolumedArchiveInStream;

<span class="java-keyword">public</span> <span class="java-keyword">class</span> OpenMultipartArchive7z {
<span class="java-javadoc">    /**
     * In this example we use VolumedArchiveInStream class only.
     * It means, we doesn't pass instances of this class directly
     * to 7-Zip, so not complete implementation
     * of {@link IArchiveOpenVolumeCallback} is required.
     * See VolumedArchiveInStream JavaDoc for more information
     */</span>
    <span class="java-keyword">private</span> <span class="java-keyword">static</span> <span class="java-keyword">class</span> ArchiveOpenVolumeCallback 
            <span class="java-keyword">implements</span> IArchiveOpenVolumeCallback {

<span class="java-javadoc">        /**
         * Cache for opened file streams
         */</span>
        <span class="java-keyword">private</span> Map&#60;String, RandomAccessFile&#62; <span class="java-field">openedRandomAccessFileList</span> = 
        <span class="java-keyword">new</span> HashMap&#60;String, RandomAccessFile&#62;();

<span class="java-javadoc">        /**
         * This method doesn't needed, if using with VolumedArchiveInStream
         * and pass the name of the first archive in constructor.
         * (Use two argument constructor)
         * 
         * <span class="java-javadoc-keyword">@see</span> IArchiveOpenVolumeCallback#getProperty(PropID)
         */</span>
        <span class="java-keyword">public</span> Object getProperty(PropID propID) <span class="java-keyword">throws</span> SevenZipException {
            <span class="java-keyword">return</span> <span class="java-keyword">null</span>;
        }

<span class="java-javadoc">        /**
         * 
         * The name of the required volume will be calculated out of the
         * name of the first volume and volume index. If you need
         * need volume index (integer) you will have to parse filename
         * and extract index.
         * 
         * &#60;pre&#62;
         * int index = filename.substring(filename.length() - 3, 
         *         filename.length());
         * &#60;/pre&#62;
         * 
         */</span>
        <span class="java-keyword">public</span> IInStream getStream(String filename) <span class="java-keyword">throws</span> SevenZipException {
            <span class="java-keyword">try</span> {
                <span class="java-comment">// We use caching of opened streams, so check cache first</span>
                RandomAccessFile randomAccessFile = <span class="java-field">openedRandomAccessFileList</span>
                        .get(filename);
                <span class="java-keyword">if</span> (randomAccessFile != <span class="java-keyword">null</span>) { <span class="java-comment">// Cache hit.</span>
                    <span class="java-comment">// Move the file pointer back to the beginning</span>
                    <span class="java-comment">// in order to emulating new stream</span>
                    randomAccessFile.seek(0);
                    <span class="java-keyword">return</span> <span class="java-keyword">new</span> RandomAccessFileInStream(randomAccessFile);
                }

                <span class="java-comment">// Nothing useful in cache. Open required volume.</span>
                randomAccessFile = <span class="java-keyword">new</span> RandomAccessFile(filename, <span class="java-string">"r"</span>);

                <span class="java-comment">// Put new stream in the cache</span>
                <span class="java-field">openedRandomAccessFileList</span>.put(filename, randomAccessFile);

                <span class="java-keyword">return</span> <span class="java-keyword">new</span> RandomAccessFileInStream(randomAccessFile);
            } <span class="java-keyword">catch</span> (FileNotFoundException fileNotFoundException) {
                <span class="java-comment">// Required volume doesn't exist. This happens if the volume:</span>
                <span class="java-comment">// 1. never exists. 7-Zip doesn't know how many volumes should</span>
                <span class="java-comment">//    exist, so it have to try each volume.</span>
                <span class="java-comment">// 2. should be there, but doesn't. This is an error case.</span>

                <span class="java-comment">// Since normal and error cases are possible,</span>
                <span class="java-comment">// we can't throw an error message</span>
                <span class="java-keyword">return</span> <span class="java-keyword">null</span>; <span class="java-comment">// We return always null in this case</span>
            } <span class="java-keyword">catch</span> (Exception e) {
                <span class="java-keyword">throw</span> <span class="java-keyword">new</span> RuntimeException(e);
            }
        }

<span class="java-javadoc">        /**
         * Close all opened streams
         */</span>
        <span class="java-keyword">void</span> close() <span class="java-keyword">throws</span> IOException {
            <span class="java-keyword">for</span> (RandomAccessFile file : <span class="java-field">openedRandomAccessFileList</span>.values()) {
                file.close();
            }
        }
    }

    <span class="java-keyword">public</span> <span class="java-keyword">static</span> <span class="java-keyword">void</span> main(String[] args) {
        <span class="java-keyword">if</span> (args.<span class="java-field">length</span> == 0) {
            System.<span class="java-staticfield">out</span>.println(
                    <span class="java-string">"Usage: java OpenMultipartArchive7z &#60;first-volume&#62;"</span>);
        }
        ArchiveOpenVolumeCallback archiveOpenVolumeCallback = <span class="java-keyword">null</span>;
        ISevenZipInArchive inArchive = <span class="java-keyword">null</span>;
        <span class="java-keyword">try</span> {

            archiveOpenVolumeCallback = <span class="java-keyword">new</span> ArchiveOpenVolumeCallback();
            inArchive = SevenZip.<span class="java-staticmethod">openInArchive</span>(ArchiveFormat.SEVEN_ZIP, 
                    <span class="java-keyword">new</span> VolumedArchiveInStream(args[0], 
                            archiveOpenVolumeCallback));

            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"   Size   | Compr.Sz. | Filename"</span>);
            System.<span class="java-staticfield">out</span>.println(<span class="java-string">"----------+-----------+---------"</span>);
            <span class="java-keyword">int</span> itemCount = inArchive.getNumberOfItems();
            <span class="java-keyword">for</span> (<span class="java-keyword">int</span> i = 0; i &#60; itemCount; i++) {
                System.<span class="java-staticfield">out</span>.println(String.<span class="java-staticmethod">format</span>(<span class="java-string">"%9s | %9s | %s"</span>, <span class="java-comment">// </span>
                        inArchive.getProperty(i, PropID.SIZE), 
                        inArchive.getProperty(i, PropID.PACKED_SIZE), 
                        inArchive.getProperty(i, PropID.PATH)));
            }
        } <span class="java-keyword">catch</span> (Exception e) {
            System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error occurs: "</span> + e);
            System.<span class="java-staticmethod">exit</span>(1);
        } <span class="java-keyword">finally</span> {
            <span class="java-keyword">if</span> (inArchive != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    inArchive.close();
                } <span class="java-keyword">catch</span> (SevenZipException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing archive: "</span> + e);
                }
            }
            <span class="java-keyword">if</span> (archiveOpenVolumeCallback != <span class="java-keyword">null</span>) {
                <span class="java-keyword">try</span> {
                    archiveOpenVolumeCallback.close();
                } <span class="java-keyword">catch</span> (IOException e) {
                    System.<span class="java-staticfield">err</span>.println(<span class="java-string">"Error closing file: "</span> + e);
                }
            }
        }
    }
}
</pre></div>
<div class="snippet-info"><a href="snippets/OpenMultipartArchive7z.java">download java code</a></div>
<p>Here is the output of the last snippet:</p>
<div class="fragment"><pre class="fragment">
   Size   | Compr.Sz. | Filename
----------+-----------+---------
        6 |       114 | folder/file in folder.txt
     4481 |      null | file1.txt
       75 |      null | file2.txt
        0 |         0 | folder
</pre></div>
</td></tr>
</table></td></tr>
</table>
</center>
</body>
</html>
